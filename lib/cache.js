// Generated by CoffeeScript 1.7.1
var LOCAL_STORAGE_PREFIX, buildKey, localStorage, memoryCache;

LOCAL_STORAGE_PREFIX = 'cachedResource://';

localStorage = window.localStorage;

memoryCache = {};

buildKey = function(key) {
  return "" + LOCAL_STORAGE_PREFIX + key;
};

module.exports = {
  getItem: function(key, fallbackValue) {
    var item;
    key = buildKey(key);
    item = memoryCache[key];
    if (item == null) {
      item = localStorage.getItem(key);
    }
    if (item != null) {
      return angular.fromJson(item);
    } else {
      return fallbackValue;
    }
  },
  setItem: function(key, value) {
    var stringValue;
    key = buildKey(key);
    stringValue = angular.toJson(value);
    try {
      localStorage.setItem(key, stringValue);
      if (memoryCache[key] != null) {
        delete memoryCache[key];
      }
    } catch (_error) {
      memoryCache[key] = stringValue;
    }
    return value;
  }
};
